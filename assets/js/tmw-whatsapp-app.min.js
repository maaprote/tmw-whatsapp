"use strict";!function(w){var t=window||{},t={initialize:function(){return this.$wrapper=w(".tmw-whatsapp-wrapper"),this.$attendant=w(".tmw-whatsapp-attendant"),this.$presentationInfo=w(".tmw-whatsapp-presentation-info"),this.$attendantHeaderInfo=w(".tmw-whatsapp-active-attendant-info"),this.$attendantHeaderImage=w(".tmw-whatsapp-attendant-info-image"),this.$chatWindow=w(".tmw-whatsapp-attendant-chat-window"),this.$chatSendButton=w(".tmw-whatsapp-attendant-chat-send-button"),this.$chatInputMessage=w(".tmw-whatsapp-attendant-chat-input-message"),this.$attendantInfoBack=w(".tmw-whatsapp-active-attendant-info-back"),this.$triggerButton=w(".tmw-whatsapp-trigger-button"),this.$closeButton=w(".tmw-whatsapp-close-button"),this.$openWhatsappChatType=w(".tmw-whatsapp-wrapper").data("tmw-open-whatsapp-chat-type"),this.build().events(),this},build:function(){var t,a=this;return a.$attendant.each(function(){var t,a,e,n,s,i=w(this),o=JSON.parse(atob(w(this).data("availability"))),d=(new Date).toLocaleString("en-us",{weekday:"long",timezone:w(this).data("default-timezone")}).toLowerCase(),p=!1;"no"==o[d].available?i.addClass("tmw-attendant-is-offline"):"yes"==o[d].available&&(i.addClass("tmw-attendant-is-online"),p=!0,""!=o[d].start&&""!=o[d].end?(n=""==o[d].timezone||o[d].timezone==w(this).data("default-timezone")?w(this).data("default-timezone"):o[d].timezone,t=moment((new Date).getFullYear()+"-"+("0"+((new Date).getMonth()+1)).slice(-2)+"-"+("0"+(new Date).getDate()).slice(-2)+"T"+o[d].start+":00").tz(n).format(),a=moment((new Date).getFullYear()+"-"+("0"+((new Date).getMonth()+1)).slice(-2)+"-"+("0"+(new Date).getDate()).slice(-2)+"T"+o[d].end+":00").tz(n).format(),e=moment((new Date).getFullYear()+"-"+("0"+((new Date).getMonth()+1)).slice(-2)+"-"+("0"+(new Date).getDate()).slice(-2)+"T"+o[d].interval_start+":00").tz(n).format(),s=moment((new Date).getFullYear()+"-"+("0"+((new Date).getMonth()+1)).slice(-2)+"-"+("0"+(new Date).getDate()).slice(-2)+"T"+o[d].interval_end+":00").tz(n).format(),n=moment().tz(n).format(),p=moment(n).isBetween(t,a),s=moment(n).isBetween(e,s)):(i.removeClass("tmw-attendant-is-offline").addClass("tmw-attendant-is-online"),i.find(".tmw-whatsapp-attendant-status .tmw-whatsapp-attendant-status-online").removeClass("tmw-d-none"),i.find(".tmw-whatsapp-attendant-info .tmw-whastapp-attendant-info-offline-message").addClass("tmw-d-none"))),(p=s?!1:p)?(i.removeClass("attendant-is-offline").addClass("tmw-attendant-is-online"),i.find(".tmw-whatsapp-attendant-status .tmw-whatsapp-attendant-status-online").removeClass("tmw-d-none"),i.find(".tmw-whatsapp-attendant-info .tmw-whastapp-attendant-info-offline-message").addClass("tmw-d-none")):s?(i.removeClass("attendant-is-online").addClass("tmw-attendant-is-offline tmw-attendant-is-interval"),i.find(".tmw-whatsapp-attendant-status .tmw-whatsapp-attendant-status-interval").removeClass("tmw-d-none"),i.find(".tmw-whatsapp-attendant-info .tmw-whastapp-attendant-info-offline-message:not(.is-interval)").addClass("tmw-d-none")):"no"!=o[d].available&&p?(i.removeClass("attendant-is-offline").addClass("tmw-attendant-is-online"),i.find(".tmw-whatsapp-attendant-status .tmw-whatsapp-attendant-status-online").removeClass("tmw-d-none")):(i.removeClass("attendant-is-online").addClass("tmw-attendant-is-offline"),i.find(".tmw-whatsapp-attendant-status .tmw-whatsapp-attendant-status-offline").removeClass("tmw-d-none"),i.find(".tmw-whatsapp-attendant-info .tmw-whastapp-attendant-info-offline-message.is-interval").addClass("tmw-d-none"))}),1===a.$attendant.length&&a.$attendant.hasClass("tmw-attendant-is-online")&&0==a.$attendant.hasClass("tmw-attendant-is-interval")&&setTimeout(function(){a.$attendant.trigger("click"),a.$attendantInfoBack.remove()},300),a.$attendant.length<=4&&a.$wrapper.find(".tmw-whatsapp-card-body").css("overflow-y","hidden"),a.$wrapper.data("open-chat-with")&&(t=""==a.$wrapper.data("open-chat-with-delay")?0:1e3*a.$wrapper.data("open-chat-with-delay"),setTimeout(function(){a.$attendant.eq(a.$wrapper.data("open-chat-with")).trigger("click"),a.$triggerButton.trigger("click")},t)),this},events:function(){var s=this,n=s.$presentationInfo.height();return s.$attendant.off("click").on("click",function(t){t.preventDefault();var a,e=w(this).find(".tmw-whatsapp-attendant-image > img"),n=w(this).find(".tmw-whatsapp-attendant-info > h3").text(),t=w(this).hasClass("tmw-attendant-is-online")?tmwc_data.i18n.attendant_online_text:tmwc_data.i18n.attendant_offline_text;"select-attendant"!=s.$openWhatsappChatType?(s.$attendantHeaderImage.attr("src",e.attr("src")),s.$attendantHeaderInfo.find(".tmw-whatsapp-attedant-info-title > h2").text(n),s.$attendantHeaderInfo.find(".tmw-whatsapp-attedant-info-title > p").text(t),""!=w(this).data("start-message")&&w(".tmw-whatsapp-attendant-chat-message").text(w(this).data("start-message")).append('<span class="tmw-whatsapp-attendant-chat-message-time">'+s.getTimeNow()+"</span>"),s.$chatSendButton.data("messageToPhone",w(this).data("phone")),a=200,s.$attendant.each(function(){var t=w(this);setTimeout(function(){t.addClass("tmw-hide")},a),a+=100}),w(".tmw-whatsapp-card-body").animate({height:230},300,function(){w(".tmw-whatsapp-card-body").scrollTop(0)}),s.$wrapper.find(".tmw-whatsapp-attendant-chat-window").css("display","block"),setTimeout(function(){s.$wrapper.find(".tmw-whatsapp-attendant-chat-window").css("display","")},150*s.$attendant.length),setTimeout(function(){s.$chatWindow.addClass("tmw-show")},150*s.$attendant.length),s.$presentationInfo.addClass("tmw-hide"),setTimeout(function(){s.$attendantHeaderInfo.removeClass("tmw-hide")},150),s.$presentationInfo.animate({height:s.$attendantHeaderInfo.height()}),s.$wrapper.addClass("tmw-whatsapp-attendant-chat-opened")):s.openWhatsappWebChat(w(this).data("phone"),s.$wrapper.data("tmw-whatsapp-web-start-message"))}),s.$attendantInfoBack.off("click").on("click",function(t){t.preventDefault(),t.stopPropagation(),s.$chatWindow.removeClass("tmw-show");var a=0;w(".tmw-whatsapp-attendant").each(function(){a+=w(this).outerHeight()}),w(".tmw-whatsapp-card-body").animate({height:a});var e=200;s.$attendant.each(function(){var t=w(this);setTimeout(function(){t.removeClass("tmw-hide")},e),e+=100}),s.$attendantHeaderInfo.addClass("tmw-hide"),setTimeout(function(){s.$presentationInfo.removeClass("tmw-hide")},150),s.$presentationInfo.animate({height:n}),s.$wrapper.removeClass("tmw-whatsapp-attendant-chat-opened")}),s.$chatSendButton.off("click").on("click",function(t){t.preventDefault(),s.openWhatsappWebChat(w(this).data("messageToPhone"),s.$chatInputMessage.val())}),s.$triggerButton.off("click").on("click",function(t){t.preventDefault();t=w(this);"click-icon"!=s.$openWhatsappChatType?t.data("opened")?(s.$wrapper.addClass("tmw-hide"),t.data("opened",!1).removeClass("tmw-whatsapp-chat-opened"),setTimeout(function(){s.$triggerButton.removeClass("tmw-hide"),w(window).width()<768&&w("html, body").css({"overflow-y":"auto"})},250)):(t.data("opened",!0).addClass("tmw-whatsapp-chat-opened"),setTimeout(function(){s.$wrapper.removeClass("tmw-hide"),w(window).width()<768&&w("html, body").css({"overflow-y":"hidden"})},250)):(t=w(".tmw-whatsapp-attendant").eq(0).data("phone"),s.openWhatsappWebChat(t,s.$wrapper.data("tmw-whatsapp-web-start-message")))}),s.$closeButton.off("click").on("click",function(t){t.preventDefault(),s.$wrapper.addClass("tmw-hide"),setTimeout(function(){s.$triggerButton.removeClass("tmw-hide")},250)}),w(".tmw-whatsapp-attendant-chat-input-message").off("keyup").on("keyup",function(t){13===t.keyCode&&(t.preventDefault(),s.$chatSendButton.trigger("click"))}),w(".tmw-whatsapp-admin-settings").off("tm.whatsapp.settings.saved").on("tm.whatsapp.settings.saved",function(){s.initialize()}),this},openWhatsappWebChat:function(t,a){return 0<t.toString().indexOf("chat.whatsapp.com")?window.open(t,"_blank"):window.open("https://wa.me/"+t+"/?text="+a,"_blank"),this},getTimeNow:function(){var t=new Date,a=t.getHours(),t=t.getMinutes();return 12<a&&(a-=12),a+":"+(t=t<10?"0"+t:t)}},a=w(".tmw-whatsapp-wrapper").data("init-method"),e=w(".tmw-whatsapp-wrapper").data("init-method-delay")?w(".tmw-whatsapp-wrapper").data("init-method-delay"):0;switch(a){case"on-first-load":t.initialize();break;case"on-first-scroll":w(window).on("scroll",function(){t.initialize(),0});break;case"on-first-mouseover":w(document).on("mouseover",function(){t.initialize(),0});break;case"after-few-seconds":setTimeout(function(){t.initialize()},1e3*e);break;default:t.initialize()}}(jQuery);